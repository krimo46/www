<?php

class GMWDControllerOptions_gmwd extends GMWDController{
	////////////////////////////////////////////////////////////////////////////////////////
	// Events                                                                             //
	////////////////////////////////////////////////////////////////////////////////////////
	////////////////////////////////////////////////////////////////////////////////////////
	// Constants                                                                          //
	////////////////////////////////////////////////////////////////////////////////////////
	////////////////////////////////////////////////////////////////////////////////////////
	// Variables                                                                          //
	////////////////////////////////////////////////////////////////////////////////////////
	////////////////////////////////////////////////////////////////////////////////////////
	// Constructor & Destructor                                                           //
	////////////////////////////////////////////////////////////////////////////////////////
	////////////////////////////////////////////////////////////////////////////////////////
	// Public Methods                                                                     //
	////////////////////////////////////////////////////////////////////////////////////////
	public function apply(){
		global $wpdb;
		$query = "SELECT name FROM ". $wpdb->prefix . "gmwd_options";
        // get option names		
        $names =  $wpdb->get_col( $query , 0 );		

        // update options
  
		for ($i = 0; $i < count($names); $i++) {
			$name = $names[$i];
			$value = isset($_POST[$name]) ? $_POST[$name] : null;
		
			if ($value !== null  ) {
				$data = array();
				$data["value"] = esc_html($value);
				$where = array("name"=>$name);
				$where_format = $format = array('%s');
				$wpdb->update( $wpdb->prefix . "gmwd_options", $data, $where, $format, $where_format );
			}
		}
	
		GMWDHelper::message(__("Options Succesfully Saved.","bwg_back"),'updated');
		$this->display();
		
	}
    
    public function setup(){
        $this->view->gmwd_setup();
    }
	public function setup_general(){
        $this->view->gmwd_setup_general();
    }
	public function setup_ready(){
        $this->view->gmwd_setup_ready();
    }	
	////////////////////////////////////////////////////////////////////////////////////////
	// Getters & Setters                                                                  //
	////////////////////////////////////////////////////////////////////////////////////////
	////////////////////////////////////////////////////////////////////////////////////////
	// Private Methods                                                                    //
	////////////////////////////////////////////////////////////////////////////////////////
	
	
	////////////////////////////////////////////////////////////////////////////////////////
	// Listeners                                                                          //
	////////////////////////////////////////////////////////////////////////////////////////
}